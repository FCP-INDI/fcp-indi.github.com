Inter-subject Correlation (ISC) & Inter-subject Functional Correlation (ISFC)
-----------------------------------------------------------------------------

Introduction & Background
^^^^^^^^^^^^^^^^^^^^^^^^^

To analyse the brain functioning, one of the ways is to explore the functional networks interactions during information processing from a task. The standard functional connectivity method provides a mixture of stimulus-induced correlations, intrinsic neural correlations and non-neuronal artificial correlations within each subject, which convolutes the functioning signals. The Inter-subject Correlation (ISC) and the Inter-subject Functional Correlation (ISFC) provide a isolated stimulus-induced correlations, taking advantage of the fact that intrinsic and non-neuronal artificial signals are uncorrelated across subjects.

ISC is used to quantify the reliability of stimulus-driven responses within each brain area, by correlating a subject's region with the average of the group. The ISFC approach extends ISC by characterizing the correlations between (a) response time courses for one seed region in one subject, and (b) the response time courses in all voxels of all other subjects.

Computation and Analysis Considerations
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In order to compute ISC and ISFC, for each region or voxel, it computes the group average on a region or every other regions and correlate it with a subject region. Thus, the computation on voxel level may take from hours to days, depending on the number of participants and the images resolution. We provide a voxel filter, to reduce the number of voxels to compute the significance. It removes the voxels on the tails of the correlation distribution, based on an informed standard deviation.

The steps for ISC and ISFC are the following:

Inter-Subject Correlation (ISC)
"""""""""""""""""""""""""""""""

For each region, computes the correlation of each subject’s timecourse with the mean of all other subjects’ timecourses. The result is averaged across subjects. A null-distribution is computed using phase randomization, to compute a p-value for each region.

Inter-Subject Functional Correlation (ISFC)
"""""""""""""""""""""""""""""""""""""""""""

Computes the correlation between the timecoure of each region in each subject with the average of all other subjects’ timecourses in all regions. The result is averaged across subjects. A null-distribution is computed using phase randomization, to compute a p-value for each region-to-region correlation.

.. figure:: /_images/isc_isfc.jpg

Image from Simony et al. `Dynamic reconfiguration of the default mode network during narrative comprehension`. Nat Commun 7 (2016)

Applications
^^^^^^^^^^^^

In order to validate the method and its implementation, we performed two analysis:

Healthy Brain Network and Age
"""""""""""""""""""""""""""""

We computed the ISC for 200 participants from the Healthy Brain Network (HBN), using the functional data of a passive stimuli paradigm in which the participants view a short video clip called The Present (3.47 min). In order to analyse it, we use two parcellations: Yeo's and Craddock's. We model the ISC of each region with the with the participant age using linear regression.

.. figure:: /_images/isc-hbn-yeo.png

.. figure:: /_images/isc-hbn-cc.png


Simony et al. study on narrative comprehension
""""""""""""""""""""""""""""""""""""""""""""""

To characterize stimulus-induced DMN correlation patterns, Simony et al. collected BOLD responses during narrative-driven and resting state conditions. Subjects listened to a real-life story (intact task), as well as to word scramble and paragraph scramble versions of the story.

By isolating the stimulus-driven responses for each task, Simony et al. demonstrated a robust activation alignment of the Default Mode Network nodes across subjects, corresponding to the processing of a coherent narrative.

The following images correspond to the correlation of the posterior cingulate cortex and the entire brain using the ISFC method. The correlations are stronger according to the coherence of the story.

.. figure:: /_images/isfc-simony-1.png

.. figure:: /_images/isfc-simony-2.png

Configuring ISC/ISFC
^^^^^^^^^^^^^^^^^^^^

Using the GUI
"""""""""""""

.. figure:: /_images/isfc.png

#. **Run ISC - [Off, On]:** Used to determine if Inter-subject Correlation (ISC) will be added to the pipeline or not.

#. **Run ISFC - [Off, On]:** Used to determine if Inter-subject Functional Correlation (ISFC) will be added to the pipeline or not.

#. **ROI analysis - [Off, On]:** Used to determine if the ISC and ISFC will run in the ROI level.

#. **Voxel-wise analysis - [Off, On]:** Used to determine if the ISC and ISFC will run in the voxel level. Depending on the image resolution, it may take several hours and consume a great amount of available memory.

#. **Voxel-wise analysis: Standard Deviation filter - [number]:** Filter out voxels that, in the correlation distribution, is greater then the informed standard deviation. Zero value will disable the filter.

#. **Permutations - [integer]:** Number of permutation tests to run on the Pseudo-F statistics.

Configuration Using a YAML File
"""""""""""""""""""""""""""""""

To configure ISC/ISFC options within a YAML file, add the following lines to your pipeline config::

    runISC: [1]
    runISFC: [1]
    isc_permutations: 1000
    isc_level_roi: [1]
    isc_level_voxel: [1]
    isc_level_voxel_std_filter: 1.5

References
^^^^^^^^^^
Hasson, U., Nir, Y., Levy, I., Fuhrmann, G. & Malach, R. 
`Intersubject synchronization of cortical activity during natural vision`. Science 303, 1634–1640 (2004).

Simony E, Honey CJ, Chen J, Lositsky O, Yeshurun Y, Wiesel A, Hasson U
`Dynamic reconfiguration of the default mode network during narrative comprehension`. Nat Commun 7 (2016). 

Kauppi, Jukka-Pekka, Iiro P. Jääskeläinen, Mikko Sams, and Jussi Tohka. 
`Inter-subject correlation of brain hemodynamic responses during watching a movie: localization in space and frequency`. Frontiers in neuroinformatics 4 (2010).

Jääskeläinen, Iiro P., Katri Koskentalo, Marja H. Balk, Taina Autti, Jaakko Kauramäki, Cajus Pomren, and Mikko Sams. 
`Inter-subject synchronization of prefrontal cortex hemodynamic activity during natural viewing`. The open neuroimaging journal 2 (2008).

Pajula, Juha, Jukka-Pekka Kauppi, and Jussi Tohka.
`Inter-subject correlation in fMRI: method validation against stimulus-model based analysis`. PloS one 7, no. 8 (2012).

Hasson U, Malach R, Heeger DJ.
`Reliability of cortical activity during natural stimulation`. Trends Cogn Sci 14:40-48 (2010).

Mukamel R, Gelbard H, Arieli A, Hasson U, Fried I, Malach R
`Coupling between neuronal firing, field potentials, and FMRI in human auditory cortex`. Science (2005).

Ben-Yakov A, Honey CJ, Lerner Y, Hasson U
`Loss of reliable temporal structure in event-related averaging of naturalistic stimuli`. NeuroImage 63:501-506 (2012).