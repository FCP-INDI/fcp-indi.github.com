*****
Nodes
*****

.. _mem_gb:

.. warning::
   A Nipype :py:class:`~nipype.pipeline.engine.nodes.Node` has an initialization parameter ``mem_gb`` that differs from the :doc:`commandline option </user/run/help>` ``--mem_gb``. While the commandline option is a limit, the Node parameter is an estimate of the most memory that Node will consume when run. The Node parameter is not a limit; rather, this value is used to allocate system resources at runtime.
   
   C-PAC automatically creates a JSON-like file called ``callback.log`` (via the function :py:func:`~CPAC.utils.monitoring.log_nodes_cb`) when running. This file includes each Node's estimated memory and memory observed at runtime. The Nipype utility function :py:func:`~nipype.utils.draw_gantt_chart.log_to_dict` reads a log file generated by ``log_nodes_cb`` to a Python dictionary.
   
   When a developer creates or modifies a Node in C-PAC, a ``mem_gb`` argument should be provided unless the default of 0.2 is expected to be sufficient. When testing, the ``mem_gb`` argument should be adjusted if the observed memory exceeds the estimate.

.. autoclass:: nipype.pipeline.engine.nodes.Node
   :special-members: __init__

.. _mem_gb:

.. autofunction:: CPAC.utils.monitoring.log_nodes_cb

.. autofunction:: nipype.utils.draw_gantt_chart.log_to_dict
