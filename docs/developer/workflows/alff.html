<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Amplitude of Low Frequency Fluctuations(ALFF) and fractional ALFF &mdash; C-PAC 0.3.9 Alpha documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.9 Alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="C-PAC 0.3.9 Alpha documentation" href="../index.html" />
    <link rel="next" title="Voxel Mirrored Homotopic Connectivity Analysis" href="vmhc.html" />
    <link rel="prev" title="Nuisance Signal Removal" href="nuisance.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="gen../index.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-mod../index.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vmhc.html" title="Voxel Mirrored Homotopic Connectivity Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nuisance.html" title="Nuisance Signal Removal"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 0.3.9 Alpha documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-CPAC.alff">
<span id="amplitude-of-low-frequency-fluctuations-alff-and-fractional-alff"></span><h1>Amplitude of Low Frequency Fluctuations(ALFF) and fractional ALFF<a class="headerlink" href="#module-CPAC.alff" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="CPAC.alff.create_alff">
<code class="descclassname">CPAC.alff.</code><code class="descname">create_alff</code><span class="sig-paren">(</span><em>wf_name='alff_workflow'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/alff.html#create_alff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.create_alff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Amplitude of low frequency oscillations(ALFF) and fractional ALFF maps</p>
<dl class="docutils">
<dt>wf_name <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Workflow name</dd>
</dl>
<dl class="docutils">
<dt>alff_workflow <span class="classifier-delimiter">:</span> <span class="classifier">workflow object</span></dt>
<dd>ALFF workflow</dd>
</dl>
<p><a class="reference external" href="https://github.com/FCP-INDI/C-PAC/blob/master/CPAC/alff/alff.py">Source</a></p>
<p>Workflow Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>hp_input.hp : list (float) 
    high pass frequencies

lp_input.lp : list (float) 
    low pass frequencies

inputspec.rest_res : string (existing nifti file)
    Nuisance signal regressed functional image

inputspec.rest_mask : string (existing nifti file)
    A mask volume(derived by dilating the motion corrected functional volume) in native space
</pre></div>
</div>
<p>Workflow Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>outputspec.alff_img : string (nifti file)
    outputs image containing the sum of the amplitudes in the low frequency band

outputspec.falff_img : string (nifti file)
    outputs image containing the sum of the amplitudes in the low frequency band divided by the amplitude of the total frequency

outputspec.alff_Z_img : string (nifti file)
    outputs image containing Normalized ALFF Z scores across full brain in native space

outputspec.falff_Z_img : string (nifti file)
    outputs image containing Normalized fALFF Z scores across full brain in native space
</pre></div>
</div>
<p>Order of Commands:</p>
<ul>
<li><dl class="first docutils">
<dt>Filter the input file rest file( slice-time, motion corrected and nuisance regressed) ::</dt>
<dd><dl class="first last docutils">
<dt>3dBandpass -prefix residual_filtered.nii.gz </dt>
<dd><p class="first last">0.009 0.08 residual.nii.gz</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Calculate ALFF by taking the standard deviation of the filtered file ::</dt>
<dd><dl class="first last docutils">
<dt>3dTstat -stdev </dt>
<dd><p class="first last">-mask rest_mask.nii.gz 
-prefix residual_filtered_3dT.nii.gz
residual_filtered.nii.gz</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Calculate the standard deviation of the unfiltered file ::</dt>
<dd><dl class="first last docutils">
<dt>3dTstat -stdev </dt>
<dd><p class="first last">-mask rest_mask.nii.gz 
-prefix residual_3dT.nii.gz
residual.nii.gz</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Calculate fALFF ::</dt>
<dd><dl class="first last docutils">
<dt>3dcalc -a rest_mask.nii.gz </dt>
<dd><p class="first last">-b residual_filtered_3dT.nii.gz
-c residual_3dT.nii.gz  
-expr &#8216;(1.0*bool(a))*((1.0*b)/(1.0*c))&#8217; -float</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p class="first">Normalize ALFF/fALFF to Z-score across full brain</p>
<div class="highlight-python"><div class="highlight"><pre>fslstats
ALFF.nii.gz
-k rest_mask.nii.gz
-m &gt; mean_ALFF.txt ; mean=$( cat mean_ALFF.txt )

fslstats
ALFF.nii.gz
-k rest_mask.nii.gz
-s &gt; std_ALFF.txt ; std=$( cat std_ALFF.txt )

fslmaths
ALFF.nii.gz
-sub ${mean}
-div ${std}
-mas rest_mask.nii.gz ALFF_Z.nii.gz

fslstats
fALFF.nii.gz
-k rest_mask.nii.gz
-m &gt; mean_fALFF.txt ; mean=$( cat mean_fALFF.txt )

fslstats
fALFF.nii.gz
-k rest_mask.nii.gz 
-s &gt; std_fALFF.txt
std=$( cat std_fALFF.txt )

fslmaths
fALFF.nii.gz
-sub ${mean}
-div ${std}
-mas rest_mask.nii.gz
fALFF_Z.nii.gz
</pre></div>
</div>
</li>
</ul>
<p>High Level Workflow Graph:</p>
<a class="reference internal image-reference" href="../_images/alff.dot.png"><img alt="../_images/alff.dot.png" src="../_images/alff.dot.png" style="width: 500px;" /></a>
<p>Detailed Workflow Graph:</p>
<a class="reference internal image-reference" href="../_images/alff_detailed.dot.png"><img alt="../_images/alff_detailed.dot.png" src="../_images/alff_detailed.dot.png" style="width: 500px;" /></a>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Zou, Q.-H., Zhu, C.-Z., Yang, Y., Zuo, X.-N., Long, X.-Y., Cao, Q.-J., Wang, Y.-F., et al. (2008). An improved approach to detection of amplitude of low-frequency fluctuation (ALFF) for resting-state fMRI: fractional ALFF. Journal of neuroscience methods, 172(1), 137-41. doi:10.10</td></tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span> <span class="o">=</span> <span class="n">create_alff</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">hp_input</span><span class="o">.</span><span class="n">hp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">lp_input</span><span class="o">.</span><span class="n">lp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s">&#39;hp_input&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;hp&#39;</span><span class="p">,[</span><span class="mf">0.01</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s">&#39;lp_input&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;lp&#39;</span><span class="p">,[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">rest_res</span> <span class="o">=</span> <span class="s">&#39;/home/data/subject/func/rest_bandpassed.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">rest_mask</span><span class="o">=</span> <span class="s">&#39;/home/data/subject/func/rest_mask.nii.gz&#39;</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">alff_w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.get_img_nvols">
<code class="descclassname">CPAC.alff.</code><code class="descname">get_img_nvols</code><span class="sig-paren">(</span><em>in_files</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#get_img_nvols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.get_img_nvols" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the number of volumes in the given nifti image</p>
<p>in_files : string (nifti file)</p>
<dl class="docutils">
<dt>out <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>number of volumes of input nifti file</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.get_img_tr">
<code class="descclassname">CPAC.alff.</code><code class="descname">get_img_tr</code><span class="sig-paren">(</span><em>in_files</em>, <em>TRa</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#get_img_tr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.get_img_tr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Temporal Resolution parameter from the image header.
If TRa is not None then it compares the computed TR and the supplied
if the difference is greater than 0.001 then it returns supplied TRa as the
TR of the image and flashes a warning message else returns TRa</p>
<p>in_files : string (nifti file)</p>
<dl class="docutils">
<dt>TRa <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>user supplied Temporal Resolution</dd>
</dl>
<dl class="docutils">
<dt>out <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>TR for input file</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.get_N1">
<code class="descclassname">CPAC.alff.</code><code class="descname">get_N1</code><span class="sig-paren">(</span><em>nvols</em>, <em>TR</em>, <em>HP</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#get_N1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.get_N1" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the low frequency point</p>
<dl class="docutils">
<dt>TR <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Temporal Resolution</dd>
<dt>nvols <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of volumes</dd>
<dt>HP <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>HighPass Low Cutoff Frequency</dd>
</dl>
<p>n1 : float</p>
<p>Low Frequency Point</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.get_N2">
<code class="descclassname">CPAC.alff.</code><code class="descname">get_N2</code><span class="sig-paren">(</span><em>nvols</em>, <em>TR</em>, <em>LP</em>, <em>HP</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#get_N2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.get_N2" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the high frequency point</p>
<dl class="docutils">
<dt>TR <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Temporal Resolution</dd>
<dt>nvols <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of volumes</dd>
<dt>LP <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>LowPass High Cutoff Frequency</dd>
<dt>HP <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>HighPass Low Cutoff Frequency</dd>
</dl>
<p>n2 : float</p>
<p>High Frequency Point</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.get_operand_string">
<code class="descclassname">CPAC.alff.</code><code class="descname">get_operand_string</code><span class="sig-paren">(</span><em>mean</em>, <em>std_dev</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#get_operand_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.get_operand_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the Operand String to be used in workflow nodes to supply 
mean and std deviation to alff workflow nodes</p>
<dl class="docutils">
<dt>mean: string</dt>
<dd>mean value in string format</dd>
<dt>std_dev <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>std deviation value in string format</dd>
</dl>
<p>op_string : string</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.set_op_str">
<code class="descclassname">CPAC.alff.</code><code class="descname">set_op_str</code><span class="sig-paren">(</span><em>n2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#set_op_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.set_op_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the operand string used by the workflow nodes</p>
<p>n2 : float</p>
<blockquote>
<div><p>strs : string</p>
<blockquote>
<div>operand string</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.set_op1_str">
<code class="descclassname">CPAC.alff.</code><code class="descname">set_op1_str</code><span class="sig-paren">(</span><em>nvols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#set_op1_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.set_op1_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the operand string used by the workflow nodes</p>
<p>nvols : int</p>
<blockquote>
<div><p>strs : string</p>
<blockquote>
<div>operand string</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="CPAC.alff.takemod">
<code class="descclassname">CPAC.alff.</code><code class="descname">takemod</code><span class="sig-paren">(</span><em>nvols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CPAC/alff/utils.html#takemod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.alff.takemod" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the input is odd or even values and 
return a of 0 and 1 depending on the truth value</p>
<p>nvols : int</p>
<p>decisions : int</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="nuisance.html"
                        title="previous chapter">Nuisance Signal Removal</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vmhc.html"
                        title="next chapter">Voxel Mirrored Homotopic Connectivity Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/alff.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="gen../index.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-mod../index.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vmhc.html" title="Voxel Mirrored Homotopic Connectivity Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="nuisance.html" title="Nuisance Signal Removal"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 0.3.9 Alpha documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>