
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Network Centrality &#8212; C-PAC 1.3.0 Beta documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Timeseries Analysis" href="timeseries.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeseries.html" title="Timeseries Analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 1.3.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Workflows</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-CPAC.network_centrality">
<span id="network-centrality"></span><h1>Network Centrality<a class="headerlink" href="#module-CPAC.network_centrality" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="CPAC.network_centrality.create_resting_state_graphs">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">create_resting_state_graphs</code><span class="sig-paren">(</span><em>wf_name='resting_state_graph'</em>, <em>allocated_memory=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#create_resting_state_graphs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.create_resting_state_graphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Workflow to calculate degree and eigenvector centrality as well as 
local functional connectivity density (lfcd) measures for the 
resting state data.</p>
<dl class="docutils">
<dt>generate_graph <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>when true the workflow plots the adjacency matrix graph 
and converts the adjacency matrix into compress sparse 
matrix and stores it in a .mat file. By default its False</dd>
<dt>wf_name <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>name of the workflow</dd>
</dl>
<dl class="docutils">
<dt>wf <span class="classifier-delimiter">:</span> <span class="classifier">workflow object</span></dt>
<dd>resting state graph workflow object</dd>
</dl>
<p><a class="reference external" href="https://github.com/FCP-INDI/C-PAC/blob/master/CPAC/network_centrality/resting_state_centrality.py">Source</a></p>
<p>Workflow Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputspec</span><span class="o">.</span><span class="n">subject</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nifti</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">resting</span> <span class="n">state</span> <span class="nb">input</span> <span class="n">data</span> <span class="k">for</span> <span class="n">which</span> <span class="n">centrality</span> <span class="n">measure</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">calculated</span>
    
<span class="n">inputspec</span><span class="o">.</span><span class="n">template</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">existing</span> <span class="n">nifti</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">mask</span><span class="o">/</span><span class="n">parcellation</span> <span class="n">unit</span> 

<span class="n">inputspec</span><span class="o">.</span><span class="n">method_option</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="mi">0</span> <span class="k">for</span> <span class="n">degree</span> <span class="n">centrality</span><span class="p">,</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">eigenvector</span> <span class="n">centrality</span><span class="p">,</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">lFCD</span>

<span class="n">inputspec</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">pvalue</span><span class="o">/</span><span class="n">sparsity_threshold</span><span class="o">/</span><span class="n">threshold</span> <span class="n">value</span>

<span class="n">inputspec</span><span class="o">.</span><span class="n">threshold_option</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">threshold</span> <span class="n">options</span><span class="p">:</span>  <span class="mi">0</span> <span class="k">for</span> <span class="n">probability</span> <span class="n">p_value</span><span class="p">,</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">sparsity</span> <span class="n">threshold</span><span class="p">,</span> <span class="nb">any</span> <span class="n">other</span> <span class="k">for</span> <span class="n">threshold</span> <span class="n">value</span>

<span class="n">centrality_options</span><span class="o">.</span><span class="n">method_options</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="nb">list</span> <span class="n">of</span> <span class="n">boolean</span><span class="p">)</span>
    <span class="nb">list</span> <span class="n">of</span> <span class="n">two</span> <span class="n">booleans</span> <span class="k">for</span> <span class="n">Degree</span> <span class="ow">and</span> <span class="n">Eigenvector</span> <span class="n">centrality</span> <span class="n">method</span> <span class="n">options</span> <span class="n">respectively</span>
</pre></div>
</div>
<p>Workflow Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputspec</span><span class="o">.</span><span class="n">centrality_outputs</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="nb">list</span> <span class="n">of</span> <span class="n">nifti</span> <span class="n">files</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">centrality</span> <span class="n">outputs</span> <span class="k">for</span> <span class="n">binarized</span> <span class="ow">or</span><span class="o">/</span><span class="ow">and</span> <span class="n">weighted</span> <span class="ow">and</span>
    <span class="n">degree</span> <span class="ow">or</span><span class="o">/</span><span class="ow">and</span> <span class="n">eigen_vector</span> 

<span class="n">outputspec</span><span class="o">.</span><span class="n">threshold_matrix</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">numpy</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">thresholded</span> <span class="n">correlation</span> <span class="n">matrix</span>

<span class="n">outputspec</span><span class="o">.</span><span class="n">correlation_matrix</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">numpy</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">correlation</span> <span class="n">matrix</span>

<span class="n">outputspec</span><span class="o">.</span><span class="n">graph_outputs</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">mat</span> <span class="ow">and</span> <span class="n">png</span> <span class="n">files</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">matlab</span> <span class="n">compatible</span> <span class="n">sparse</span> <span class="n">adjacency</span> <span class="n">matrix</span> <span class="n">files</span> 
    <span class="ow">and</span> <span class="n">adjacency</span> <span class="n">graph</span> <span class="n">images</span> 
</pre></div>
</div>
<p>Order of commands:</p>
<ul class="simple">
<li>load the data and template, based on template type (parcellation unit ar mask)
extract timeseries</li>
<li>Calculate the correlation matrix for the image data for each voxel in the mask or node
in the parcellation unit</li>
<li>Based on threshold option (p_value or sparsity_threshold), calculate the threshold value</li>
<li>Threshold the correlation matrix</li>
<li>Based on weight options for edges in the network (binarize or weighted), calculate Degree 
or Vector Based centrality measures</li>
</ul>
<p>High Level Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/resting_state_centrality.dot.png"><img alt="workflows/../images/resting_state_centrality.dot.png" src="workflows/../images/resting_state_centrality.dot.png" style="width: 1000px;" /></a>
<p>Detailed Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/resting_state_centrality_detailed.dot.png"><img alt="workflows/../images/resting_state_centrality_detailed.dot.png" src="workflows/../images/resting_state_centrality_detailed.dot.png" style="width: 1000px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">resting_state_centrality</span> <span class="k">as</span> <span class="nn">graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">create_resting_state_graphs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">centrality_options</span><span class="o">.</span><span class="n">method_options</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">datafile</span> <span class="o">=</span> <span class="s1">&#39;/home/work/data/rest_mc_MNI_TR_3mm.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;/home/work/data/mask_3mm.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">threshold_option</span> <span class="o">=</span> <span class="s1">&#39;Correlation threshold&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.0744</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;graph_working_directory&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wflow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.load">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">load</code><span class="sig-paren">(</span><em>datafile</em>, <em>template=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to read data from datafile and mask/parcellation unit
and store the mask data, timeseries, affine matrix, mask type
and scans. The output of this method is used by all other nodes.</p>
<p>Note that this function also will internally compute it’s own 
brain mask by getting all voxels with non-zero variance in the
timeseries.</p>
<dl class="docutils">
<dt>datafile <span class="classifier-delimiter">:</span> <span class="classifier">string (nifti file)</span></dt>
<dd>path to subject data file</dd>
<dt>template <span class="classifier-delimiter">:</span> <span class="classifier">string (nifti file) or None (default: None)</span></dt>
<dd>path to mask/parcellation unit
if none, then will be mask with all 1s</dd>
</dl>
<dl class="docutils">
<dt>timeseries_data <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Masked timeseries of the input data.</dd>
<dt>affine <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Affine matrix of the input data</dd>
<dt>final_mask <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Mask/parcellation unit matrix</dd>
<dt>template_type <span class="classifier-delimiter">:</span> <span class="classifier">string </span></dt>
<dd>0 for mask, 1 for parcellation unit</dd>
<dt>scans <span class="classifier-delimiter">:</span> <span class="classifier">string (int)</span></dt>
<dd>total no of scans in the input data</dd>
</dl>
<p>Exception</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.get_centrality_by_rvalue">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">get_centrality_by_rvalue</code><span class="sig-paren">(</span><em>ts_normd</em>, <em>template</em>, <em>method_option</em>, <em>r_value</em>, <em>block_size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#get_centrality_by_rvalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.get_centrality_by_rvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate degree/eigenvector centrality and lFCD
via correlation (r-value) threshold</p>
<dl class="docutils">
<dt>ts_normd <span class="classifier-delimiter">:</span> <span class="classifier">ndarray (float)</span></dt>
<dd>timeseries of shape (ntpts x nvoxs) that is normalized; i.e. the data 
is demeaned and divided by its L2-norm</dd>
<dt>template <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>three dimensional array with non-zero elements corresponding to the
indices at which the lFCD metric is analyzed</dd>
<dt>method_option <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>0 - degree centrality calculation, 
1 - eigenvector centrality calculation, 
2 - lFCD calculation</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">a float</span></dt>
<dd>threshold (as correlation r) value</dd>
<dt>block_size <span class="classifier-delimiter">:</span> <span class="classifier">an integer</span></dt>
<dd>the number of rows (voxels) to compute timeseries correlation over
at any one time</dd>
</dl>
<dl class="docutils">
<dt>out_list <span class="classifier-delimiter">:</span> <span class="classifier">list (string, ndarray)</span></dt>
<dd>list of (string,ndarray) elements corresponding to:
string - the name of the metric
ndarray - the array of values to be mapped for that metric</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.get_centrality_by_sparsity">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">get_centrality_by_sparsity</code><span class="sig-paren">(</span><em>ts_normd</em>, <em>method_option</em>, <em>threshold</em>, <em>block_size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#get_centrality_by_sparsity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.get_centrality_by_sparsity" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate degree/eigenvector centrality via sparsity threshold</p>
<dl class="docutils">
<dt>ts_normd <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>timeseries of shape (ntpts x nvoxs) that is normalized; i.e. the data 
is demeaned and divided by its L2-norm</dd>
<dt>method_option <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>0 - degree centrality calculation, 
1 - eigenvector centrality calculation, 
2 - lFCD calculation</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">a float</span></dt>
<dd>sparsity_threshold value</dd>
<dt>block_size <span class="classifier-delimiter">:</span> <span class="classifier">an integer</span></dt>
<dd>the number of rows (voxels) to compute timeseries correlation over
at any one time</dd>
</dl>
<dl class="docutils">
<dt>out_list <span class="classifier-delimiter">:</span> <span class="classifier">list (string, ndarray)</span></dt>
<dd>list of (string,ndarray) elements corresponding to:
string - the name of the metric
ndarray - the array of values to be mapped for that metric</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.get_centrality_fast">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">get_centrality_fast</code><span class="sig-paren">(</span><em>timeseries</em>, <em>method_options</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#get_centrality_fast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.get_centrality_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate degree and eigen vector centrality. 
Relative to <cite>get_centrality_opt</cite>, it runs fast by not directly computing 
the correlation matrix. As a consequence, there are several differences/
limitations from the standard approach:</p>
<ol class="arabic simple">
<li>Cannot specify a correlation threshold</li>
<li>As a consequence, the weighted dense matrix centrality is computed</li>
<li>No memory limit is specified since it is assumed to be ok</li>
</ol>
<p>Note that the approach doesn’t directly calculate the complete correlation
matrix.</p>
<dl class="docutils">
<dt>timeseries_data <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>timeseries of the input subject</dd>
<dt>method_options <span class="classifier-delimiter">:</span> <span class="classifier">string (list of boolean)</span></dt>
<dd>list of two booleans for binarize and weighted options respectively</dd>
</dl>
<dl class="docutils">
<dt>out_list <span class="classifier-delimiter">:</span> <span class="classifier">string (list of tuples)</span></dt>
<dd>list of tuple containing output name to be used to store nifti image
for centrality and centrality matrix. this will only be weighted since
the fast approaches are limited to this type of output.</dd>
</dl>
<p>Exception</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.map_centrality_matrix">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">map_centrality_matrix</code><span class="sig-paren">(</span><em>centrality_matrix</em>, <em>aff</em>, <em>mask</em>, <em>template_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/utils.html#map_centrality_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.map_centrality_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to map centrality matrix to a nifti image</p>
<dl class="docutils">
<dt>centrality_matrix <span class="classifier-delimiter">:</span> <span class="classifier">tuple (string, array_like)</span></dt>
<dd>tuple containing matrix name and degree/eigenvector centrality matrix</dd>
<dt>aff <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Affine matrix of the input data</dd>
<dt>mask <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>Mask or roi data matrix</dd>
<dt>template_type <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>type of template: 0 for mask, 1 for roi</dd>
</dl>
<dl class="docutils">
<dt>out_file <span class="classifier-delimiter">:</span> <span class="classifier">string (nifti image)</span></dt>
<dd>nifti image mapped from the centrality matrix</dd>
</dl>
<p>Exception</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.get_cent_zscore">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">get_cent_zscore</code><span class="sig-paren">(</span><em>wf_name='z_score'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/z_score.html#get_cent_zscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.get_cent_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Workflow to calculate z-scores</p>
<dl class="docutils">
<dt>wf_name <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>name of the workflow</dd>
</dl>
<p>wf : workflow object</p>
<p><a class="reference external" href="https://github.com/FCP-INDI/C-PAC/blob/master/CPAC/network_centrality/z_score.py">Source</a></p>
<p>Workflow Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputspec</span><span class="o">.</span><span class="n">input_file</span> <span class="p">:</span> <span class="n">string</span>
    <span class="n">path</span> <span class="n">to</span> <span class="nb">input</span> <span class="n">functional</span> <span class="n">derivative</span> <span class="n">file</span> <span class="k">for</span> <span class="n">which</span> <span class="n">z</span> <span class="n">score</span> <span class="n">has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">calculated</span>
<span class="n">inputspec</span><span class="o">.</span><span class="n">mask_file</span> <span class="p">:</span> <span class="n">string</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">whole</span> <span class="n">brain</span> <span class="n">functional</span> <span class="n">mask</span> <span class="n">file</span> <span class="n">required</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">zscore</span>
</pre></div>
</div>
<p>Workflow Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputspec</span><span class="o">.</span><span class="n">z_score_img</span> <span class="p">:</span> <span class="n">string</span>
     <span class="n">path</span> <span class="n">to</span> <span class="n">image</span> <span class="n">containing</span> <span class="n">Normalized</span> <span class="n">Input</span> <span class="n">Image</span> <span class="n">Z</span> <span class="n">scores</span> <span class="n">across</span> <span class="n">full</span> <span class="n">brain</span><span class="o">.</span>
</pre></div>
</div>
<p>High Level Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/zscore.dot.png"><img alt="workflows/../images/zscore.dot.png" src="workflows/../images/zscore.dot.png" style="width: 500px;" /></a>
<p>Detailed Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/zscore_detailed.dot.png"><img alt="workflows/../images/zscore_detailed.dot.png" src="workflows/../images/zscore_detailed.dot.png" style="width: 500px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">get_zscore</span> <span class="k">as</span> <span class="nn">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">get_zscore</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;/home/data/graph_working_dir/calculate_centrality/degree_centrality_binarize.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">mask_file</span> <span class="o">=</span> <span class="s1">&#39;/home/data/graphs/GraphGeneration/new_mask_3m.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.calc_corrcoef">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">calc_corrcoef</code><span class="sig-paren">(</span><em>X</em>, <em>Y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/utils.html#calc_corrcoef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.calc_corrcoef" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate correlation 
Each of the columns in X will be correlated 
with each of the columns in Y. Each column 
represents a variable, with the rows containing the observations.</p>
<dl class="docutils">
<dt>X <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>array of shape x1, x2</dd>
<dt>Y <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>array of shape y1, y2</dd>
</dl>
<dl class="docutils">
<dt>r <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>array containing correlation values of shape x2, y2</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.calc_centrality">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">calc_centrality</code><span class="sig-paren">(</span><em>in_file</em>, <em>template</em>, <em>method_option</em>, <em>threshold_option</em>, <em>threshold</em>, <em>allocated_memory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/resting_state_centrality.html#calc_centrality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.calc_centrality" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate centrality and map them to a nifti file</p>
<dl class="docutils">
<dt>in_file <span class="classifier-delimiter">:</span> <span class="classifier">string (nifti file)</span></dt>
<dd>path to subject data file</dd>
<dt>template <span class="classifier-delimiter">:</span> <span class="classifier">string (nifti file)</span></dt>
<dd>path to mask/parcellation unit</dd>
<dt>method_option <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>accepted values are ‘degree centrality’, ‘eigenvector centrality’, and
‘lfcd’</dd>
<dt>threshold_option <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>accepted values are: ‘significance’, ‘sparsity’, and ‘correlation’</dd>
<dt>threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>pvalue/sparsity_threshold/threshold value</dd>
<dt>allocated_memory <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>amount of memory allocated to degree centrality</dd>
</dl>
<dl class="docutils">
<dt>out_list <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>list containing out mapped centrality images</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.convert_pvalue_to_r">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">convert_pvalue_to_r</code><span class="sig-paren">(</span><em>datafile</em>, <em>p_value</em>, <em>two_tailed=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/utils.html#convert_pvalue_to_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.convert_pvalue_to_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate correlation threshold from p_value</p>
<dl class="docutils">
<dt>datafile <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>filepath to dataset to extract number of time pts from</dd>
<dt>p_value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>significance threshold p-value</dd>
<dt>two_tailed <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional); default=False</span></dt>
<dd>flag to indicate whether to calculate the two-tailed t-test
threshold for the returned correlation value</dd>
</dl>
<dl class="docutils">
<dt>r_value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>correlation threshold value</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.calc_blocksize">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">calc_blocksize</code><span class="sig-paren">(</span><em>timeseries</em>, <em>memory_allocated=None</em>, <em>include_full_matrix=False</em>, <em>sparsity_thresh=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/utils.html#calc_blocksize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.calc_blocksize" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate blocksize to calculate correlation matrix
as per the memory allocated by the user. By default, the block
size is 1000 when no memory limit is specified.</p>
<p>If memory allocated is specified, then block size is calculated
as memory allocated subtracted by the memory of the timeseries 
and centrality output, then divided by the size of one correlation 
map. That is how many correlation maps can we calculate simultaneously 
in memory?</p>
<dl class="docutils">
<dt>timeseries <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>timeseries data: <cite>nvoxs</cite> x <cite>ntpts</cite></dd>
<dt>memory_allocated <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>memory allocated in GB for degree centrality</dd>
<dt>include_full_matrix <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Boolean indicating if we’re using the entire correlation matrix
in RAM (needed during eigenvector centrality).
Default is False</dd>
<dt>sparsity_thresh <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>a number between 0 and 1 that represents the number of
connections to keep during sparsity thresholding.
Default is 0.0.</dd>
</dl>
<dl class="docutils">
<dt>block_size <span class="classifier-delimiter">:</span> <span class="classifier">an integer</span></dt>
<dd>size of block for matrix calculation</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.degree_centrality">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">degree_centrality</code><span class="sig-paren">(</span><em>corr_matrix</em>, <em>r_value</em>, <em>method</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/core.html#degree_centrality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.degree_centrality" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate centrality for the rows in the corr_matrix using
a specified correlation threshold. The centrality output can 
be binarized or weighted.</p>
<p>corr_matrix : numpy.ndarray
r_value : float
method : str</p>
<blockquote>
<div>Can be ‘binarize’ or ‘weighted’</div></blockquote>
<dl class="docutils">
<dt>out <span class="classifier-delimiter">:</span> <span class="classifier">numpy.ndarray (optional)</span></dt>
<dd>If specified then should have shape of <cite>corr_matrix.shape[0]</cite></dd>
</dl>
<p>out : numpy.ndarray</p>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.eigenvector_centrality">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">eigenvector_centrality</code><span class="sig-paren">(</span><em>corr_matrix</em>, <em>r_value=None</em>, <em>method=None</em>, <em>to_transform=False</em>, <em>ret_eigenvalue=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/core.html#eigenvector_centrality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.eigenvector_centrality" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate Data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ntpts</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">nvoxs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">ntpts</span><span class="p">,</span><span class="n">nvoxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="c1"># note that need to generate connectivity matrix here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Execute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CPAC.network_centrality.core</span> <span class="k">import</span> <span class="n">eigenvector_centrality</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eigenvector</span> <span class="o">=</span> <span class="n">slow_eigenvector_centrality</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.network_centrality.fast_eigenvector_centrality">
<code class="descclassname">CPAC.network_centrality.</code><code class="descname">fast_eigenvector_centrality</code><span class="sig-paren">(</span><em>m</em>, <em>maxiter=99</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/network_centrality/core.html#fast_eigenvector_centrality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.network_centrality.fast_eigenvector_centrality" title="Permalink to this definition">¶</a></dt>
<dd><p>The output here is based on a transfered correlation matrix of m.
Where it equals (1+r)/2.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Wink, A.M., de Munck, J.C., van der Werf, Y.D., van den Heuvel, O.A., Barkhof, F., 2012. Fast Eigenvector Centrality Mapping of Voxel-Wise Connectivity in Functional Magnetic Resonance Imaging: Implementation, Validation, and Interpretation. Brain Connectivity 2, 265–274.</td></tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate Data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ntpts</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">nvoxs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">ntpts</span><span class="p">,</span><span class="n">nvoxs</span><span class="p">))</span> <span class="c1"># note that don&#39;t need to generate connectivity matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Execute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CPAC.network_centrality.core</span> <span class="k">import</span> <span class="n">fast_eigenvector_centrality</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eigenvector</span> <span class="o">=</span> <span class="n">fast_eigenvector_centrality</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="timeseries.html"
                        title="previous chapter">Timeseries Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/workflows/network_centrality.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeseries.html" title="Timeseries Analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 1.3.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Workflows</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>

  </body>
</html>