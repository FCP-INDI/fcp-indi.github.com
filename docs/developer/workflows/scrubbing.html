
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Scrubbing &#8212; C-PAC 1.3.0 Beta documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Group Analysis" href="group_analysis.html" />
    <link rel="prev" title="Generate Motion and Power Statistics" href="generate_motion_statistics.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_analysis.html" title="Group Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generate_motion_statistics.html" title="Generate Motion and Power Statistics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 1.3.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Workflows</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-CPAC.scrubbing">
<span id="scrubbing"></span><h1>Scrubbing<a class="headerlink" href="#module-CPAC.scrubbing" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="CPAC.scrubbing.create_scrubbing_preproc">
<code class="descclassname">CPAC.scrubbing.</code><code class="descname">create_scrubbing_preproc</code><span class="sig-paren">(</span><em>wf_name='scrubbing'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/scrubbing/scrubbing.html#create_scrubbing_preproc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.scrubbing.create_scrubbing_preproc" title="Permalink to this definition">¶</a></dt>
<dd><p>This workflow essentially takes the list of offending timepoints that are to be removed
and removes it from the motion corrected input image. Also, it removes the information
of discarded time points from the movement parameters file obtained during motion correction.</p>
<dl class="docutils">
<dt>wf_name <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Name of the workflow</dd>
</dl>
<dl class="docutils">
<dt>scrub <span class="classifier-delimiter">:</span> <span class="classifier">object</span></dt>
<dd>Scrubbing workfow object</dd>
</dl>
<p><a class="reference external" href="https://github.com/openconnectome/C-PAC/blob/master/CPAC/scrubbing/scrubbing.py">Source</a></p>
<p>Workflow Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputspec</span><span class="o">.</span><span class="n">frames_in_ID</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">mat</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="n">containing</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">time</span> <span class="n">points</span> <span class="k">for</span> <span class="n">which</span> <span class="n">FD</span> <span class="o">&gt;</span> <span class="n">threshold</span>
<span class="n">inputspec</span><span class="o">.</span><span class="n">movement_parameters</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">mat</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="n">containing</span> <span class="mi">1</span><span class="n">D</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">six</span> <span class="n">movement</span><span class="o">/</span><span class="n">motion</span> <span class="n">parameters</span>
    <span class="p">(</span><span class="mi">3</span> <span class="n">Translation</span><span class="p">,</span> <span class="mi">3</span> <span class="n">Rotations</span><span class="p">)</span> <span class="ow">in</span> <span class="n">different</span> <span class="n">columns</span> 
<span class="n">inputspec</span><span class="o">.</span><span class="n">preprocessed</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nifti</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">preprocessed</span> <span class="nb">input</span> <span class="n">image</span> <span class="n">path</span>
</pre></div>
</div>
<p>Workflow Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputspec</span><span class="o">.</span><span class="n">preprocessed</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nifti</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">preprocessed</span> <span class="n">scrubbed</span> <span class="n">output</span> <span class="n">image</span> 
<span class="n">outputspec</span><span class="o">.</span><span class="n">scrubbed_movement_parameters</span> <span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">mat</span> <span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="n">to</span> <span class="mi">1</span><span class="n">D</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">six</span> <span class="n">movement</span><span class="o">/</span><span class="n">motion</span> <span class="n">parameters</span>
    <span class="k">for</span> <span class="n">the</span> <span class="n">timepoints</span> <span class="n">which</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">discarded</span> <span class="n">by</span> <span class="n">scrubbing</span>
</pre></div>
</div>
<p>Order of Commands:</p>
<ul>
<li><p class="first">Remove all movement parameters for all the time frames other than those that are present
in the frames_in_1D file</p>
</li>
<li><p class="first">Remove the discarded timepoints from the input image. For details see <a class="reference external" href="http://afni.nimh.nih.gov/pub/dist/doc/program_help/3dcalc.html">3dcalc</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="n">dcalc</span> <span class="o">-</span><span class="n">a</span> <span class="n">bandpassed_demeaned_filtered</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">287</span><span class="p">,</span><span class="mi">288</span><span class="p">,</span><span class="mi">289</span><span class="p">,</span><span class="mi">290</span><span class="p">,</span><span class="mi">291</span><span class="p">,</span><span class="mi">292</span><span class="p">,</span><span class="mi">293</span><span class="p">,</span><span class="mi">294</span><span class="p">,</span><span class="mi">295</span><span class="p">]</span> 
       <span class="o">-</span><span class="n">expr</span> <span class="s1">&#39;a&#39;</span> <span class="o">-</span><span class="n">prefix</span> <span class="n">bandpassed_demeaned_filtered_3dc</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</li>
</ul>
<p>High Level Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/scrubbing.dot.png"><img alt="workflows/../images/scrubbing.dot.png" src="workflows/../images/scrubbing.dot.png" style="width: 500px;" /></a>
<p>Detailed Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/scrubbing_detailed.dot.png"><img alt="workflows/../images/scrubbing_detailed.dot.png" src="workflows/../images/scrubbing_detailed.dot.png" style="width: 500px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scrubbing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">scrubbing</span><span class="o">.</span><span class="n">create_scrubbing_preproc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputspec</span><span class="o">.</span><span class="n">frames_in_ID</span> <span class="o">=</span> <span class="s1">&#39;frames_in.1D&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputpsec</span><span class="o">.</span><span class="n">movement_parameters</span> <span class="o">=</span> <span class="s1">&#39;rest_mc.1D&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">inputpsec</span><span class="o">.</span><span class="n">preprocessed</span> <span class="o">=</span> <span class="s1">&#39;rest_pp.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="o">--</span> <span class="n">SKIP</span> <span class="n">doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.scrubbing.get_mov_parameters">
<code class="descclassname">CPAC.scrubbing.</code><code class="descname">get_mov_parameters</code><span class="sig-paren">(</span><em>infile_a</em>, <em>infile_b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/scrubbing/scrubbing.html#get_mov_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.scrubbing.get_mov_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the new movement parameters
file after removing the offending time frames 
(i.e., those exceeding FD 0.5mm/0.2mm threshold)</p>
<dl class="docutils">
<dt>infile_a <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>path to file containing the valid time frames</dd>
<dt>infile_b <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>path to the file containing  motion parameters</dd>
</dl>
<dl class="docutils">
<dt>out_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>path to the file containing motion parameters
for the valid time frames</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.scrubbing.get_indx">
<code class="descclassname">CPAC.scrubbing.</code><code class="descname">get_indx</code><span class="sig-paren">(</span><em>scrub_input</em>, <em>frames_in_1D_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/scrubbing/scrubbing.html#get_indx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.scrubbing.get_indx" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the list of time 
frames that are to be included</p>
<dl class="docutils">
<dt>in_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>path to file containing the valid time frames</dd>
</dl>
<dl class="docutils">
<dt>scrub_input_string <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>input string for 3dCalc in scrubbing workflow,
looks something like ” 4dfile.nii.gz[0,1,2,..100] “</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="generate_motion_statistics.html"
                        title="previous chapter">Generate Motion and Power Statistics</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="group_analysis.html"
                        title="next chapter">Group Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/workflows/scrubbing.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="group_analysis.html" title="Group Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="generate_motion_statistics.html" title="Generate Motion and Power Statistics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 1.3.0 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Workflows</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>