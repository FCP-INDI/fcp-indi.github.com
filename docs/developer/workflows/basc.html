<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Bootstrap Analysis of Stable Clusters &mdash; C-PAC 0.3.9 Alpha documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.9 Alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="C-PAC 0.3.9 Alpha documentation" href="../index.html" />
    <link rel="up" title="Workflows" href="index.html" />
    <link rel="next" title="Nuisance Signal Removal" href="nuisance.html" />
    <link rel="prev" title="Seed Based Correlation Analysis" href="sca.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nuisance.html" title="Nuisance Signal Removal"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sca.html" title="Seed Based Correlation Analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 0.3.9 Alpha documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Workflows</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-CPAC.basc">
<span id="bootstrap-analysis-of-stable-clusters"></span><h1>Bootstrap Analysis of Stable Clusters<a class="headerlink" href="#module-CPAC.basc" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="CPAC.basc.create_basc">
<code class="descclassname">CPAC.basc.</code><code class="descname">create_basc</code><span class="sig-paren">(</span><em>name='basc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/basc.html#create_basc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.create_basc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bootstrap Analysis of Stable Clusters (BASC)</p>
<p>This workflow performs group-level BASC.</p>
<dl class="docutils">
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd>Name of the workflow.</dd>
</dl>
<dl class="docutils">
<dt>basc <span class="classifier-delimiter">:</span> <span class="classifier">nipype.pipeline.engine.Workflow</span></dt>
<dd>BASC workflow.</dd>
</dl>
<p>Workflow Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>inputspec.roi : string (nifti file)
    Mask of region(s) of interest
inputpsec.subjects : list (nifti files)
    4-D timeseries of a group of subjects normalized to MNI space
inputspec.dataset_bootstraps : integer
    Number of bootstrap samples of the dataset
inputspec.timeseries_bootstraps : integer
    Number of bootstraps of each subject&#39;s timeseries
inputspec.k_clusters : integer
    Number of clusters at both the individiual and group level
inputspec.affinity_threshold : list (floats)
    Minimum threshold for similarity matrix based on correlation to create an edge
</pre></div>
</div>
<p>Workflow Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>outputspec.gsm : ndarray
    Group stability matrix
outputspec.gsclusters: ndarray
    Matrix partitioning each cluster of the group stability matrix
outputspec.gsmap: ndarray
    Group stability map using gsm and gscluster to calculate average within-cluster stability
outputspec.gsclusters_img : string (nifti file)
    3-D volume of brain regions partitioned with gsclusters
outputspec.gsmap_img : string (nifti file)
    3-D volume of brain regions associated with gs_map
outputspec.ismap_imgs : list of strings (nifti files)
    3-D volumes of stability scores of each cluster based on group clustering
</pre></div>
</div>
<p>BASC Procedure:</p>
<ol class="arabic simple">
<li>Generate individual stability matrices based on multiple clusterings of each bootstrap sample for a single subject</li>
<li>Use stratified bootstrap to sample new datasets of subjects</li>
<li>Calculate average stability matrix of each new dataset using individual stability matrices generated at step 1</li>
<li>Cluster each average stabiilty matrix</li>
<li>Average to create a group stability matrix</li>
<li>Cluster the group stability matrix</li>
<li>Calculate average within-cluster stability based on the clustering of step 6</li>
</ol>
<p>Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/basc.dot.png"><img alt="workflows/../images/basc.dot.png" src="workflows/../images/basc.dot.png" style="width: 500px;" /></a>
<p>Detailed Workflow Graph:</p>
<a class="reference internal image-reference" href="workflows/../images/basc_detailed.dot.png"><img alt="workflows/../images/basc_detailed.dot.png" src="workflows/../images/basc_detailed.dot.png" style="width: 500px;" /></a>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><ol class="first last upperalpha simple" start="16">
<li>Bellec, P. Rosa-Neto, O. C. Lyttelton, H. Benali, and A. C. Evans, &#8220;Multi-level bootstrap analysis of stable clusters in resting-state fMRI.,&#8221; NeuroImage, vol. 51, no. 3, pp. 1126-39, Jul. 2010.</li>
</ol>
</td></tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CPAC</span> <span class="kn">import</span> <span class="n">basc</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.nifti_individual_stability">
<code class="descclassname">CPAC.basc.</code><code class="descname">nifti_individual_stability</code><span class="sig-paren">(</span><em>subject_file</em>, <em>roi_mask_file</em>, <em>n_bootstraps</em>, <em>k_clusters</em>, <em>cbb_block_size=None</em>, <em>affinity_threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/basc.html#nifti_individual_stability"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.nifti_individual_stability" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the individual stability matrix for a single subject by using Circular Block Bootstrapping method
for time-series data.</p>
<dl class="docutils">
<dt>subject_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Nifti file of a subject</dd>
<dt>roi_mask_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Region of interest (this method is too computationally intensive to perform on a whole-brain volume)</dd>
<dt>n_bootstraps <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of bootstraps</dd>
<dt>k_clusters <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of clusters</dd>
<dt>cbb_block_size <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd>Size of the time-series block when performing circular block bootstrap</dd>
<dt>affinity_threshold <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Minimum threshold for similarity matrix based on correlation to create an edge</dd>
</dl>
<dl class="docutils">
<dt>ism <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Individual stability matrix of shape (<cite>V</cite>, <cite>V</cite>), <cite>V</cite> voxels</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.group_stability_matrix">
<code class="descclassname">CPAC.basc.</code><code class="descname">group_stability_matrix</code><span class="sig-paren">(</span><em>indiv_stability_list</em>, <em>n_bootstraps</em>, <em>k_clusters</em>, <em>stratification=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/basc.html#group_stability_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.group_stability_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the group stability matrix of the entire dataset by bootstrapping the dataset</p>
<dl class="docutils">
<dt>indiv_stability_list <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>A length <cite>N</cite> list of file paths to numpy matrices of shape (<cite>V</cite>, <cite>V</cite>), <cite>N</cite> subjects, <cite>V</cite> voxels</dd>
<dt>n_bootstraps <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of bootstrap datasets</dd>
<dt>k_clusters <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of clusters</dd>
<dt>stratification <span class="classifier-delimiter">:</span> <span class="classifier">array_like, optional</span></dt>
<dd>List of integer entries denoting stratums for indiv_stability_list</dd>
</dl>
<dl class="docutils">
<dt>G <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Group stability matrix of shape (<cite>V</cite>, <cite>V</cite>), <cite>V</cite> voxels</dd>
<dt>clusters_G <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Length <cite>V</cite> array of cluster assignments for each voxel</dd>
<dt>cluster_voxel_scores <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><cite>K</cite> by <cite>V</cite> matrix of within-cluster average values for each cluster of each voxel</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.ndarray_to_vol">
<code class="descclassname">CPAC.basc.</code><code class="descname">ndarray_to_vol</code><span class="sig-paren">(</span><em>data_array</em>, <em>roi_mask_file</em>, <em>sample_file</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/basc.html#ndarray_to_vol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.ndarray_to_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a numpy array to a nifti file given an roi mask</p>
<dl class="docutils">
<dt>data_array <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A data array with the same column length and index alignment as the given roi_mask_file.  If data_array is two dimensional,
first dimension is considered temporal dimension</dd>
<dt>roi_mask_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Path of the roi_mask_file</dd>
<dt>sample_file <span class="classifier-delimiter">:</span> <span class="classifier">string or list of strings</span></dt>
<dd>Path of sample nifti file(s) to use for header of the output.  If list, the first file is chosen.</dd>
<dt>filename <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Name of output file</dd>
</dl>
<dl class="docutils">
<dt>img_file <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Path of the nifti file output</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.individual_group_clustered_maps">
<code class="descclassname">CPAC.basc.</code><code class="descname">individual_group_clustered_maps</code><span class="sig-paren">(</span><em>indiv_stability_list</em>, <em>clusters_G</em>, <em>roi_mask_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/basc.html#individual_group_clustered_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.individual_group_clustered_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the individual stability maps of each subject based on the group stability clustering solution.</p>
<dl class="docutils">
<dt>indiv_stability_list <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>A length <cite>N</cite> list of file paths to numpy matrices of shape (<cite>V</cite>, <cite>V</cite>), <cite>N</cite> subjects, <cite>V</cite> voxels</dd>
<dt>clusters_G <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Length <cite>V</cite> array of cluster assignments for each voxel</dd>
</dl>
<dl class="docutils">
<dt>individual_cluster_voxel_scores <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>A length <cite>N</cite> list of nifti files of the individual group clustered stability maps for each cluster.  Temporal
dimension of each file corresponds to each subject.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.timeseries_bootstrap">
<code class="descclassname">CPAC.basc.</code><code class="descname">timeseries_bootstrap</code><span class="sig-paren">(</span><em>tseries</em>, <em>block_size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#timeseries_bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.timeseries_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a bootstrap sample derived from the input time-series.  Utilizes Circular-block-bootstrap method described in <a href="#id6"><span class="problematic" id="id7"><span id="id2"></span>[1]_</span></a>.</p>
<dl class="docutils">
<dt>tseries <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of shapes (<cite>M</cite>, <cite>N</cite>) with <cite>M</cite> timepoints and <cite>N</cite> variables</dd>
<dt>block_size <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Size of the bootstrapped blocks</dd>
</dl>
<dl class="docutils">
<dt>bseries <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Bootstrap sample of the input timeseries</dd>
</dl>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>P. Bellec; G. Marrelec; H. Benali, A bootstrap test to investigate
changes in brain connectivity for functional MRI. Statistica Sinica, 
special issue on Statistical Challenges and Advances in Brain Science, 
2008, 18: 1253-1268.</td></tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_bootstrap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([[ 7, 17, 27, 37, 47],</span>
<span class="go">       [ 8, 18, 28, 38, 48],</span>
<span class="go">       [ 9, 19, 29, 39, 49],</span>
<span class="go">       [ 4, 14, 24, 34, 44],</span>
<span class="go">       [ 5, 15, 25, 35, 45],</span>
<span class="go">       [ 6, 16, 26, 36, 46],</span>
<span class="go">       [ 0, 10, 20, 30, 40],</span>
<span class="go">       [ 1, 11, 21, 31, 41],</span>
<span class="go">       [ 2, 12, 22, 32, 42],</span>
<span class="go">       [ 4, 14, 24, 34, 44]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.standard_bootstrap">
<code class="descclassname">CPAC.basc.</code><code class="descname">standard_bootstrap</code><span class="sig-paren">(</span><em>dataset</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#standard_bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.standard_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a bootstrap sample from the input dataset</p>
<dl class="docutils">
<dt>dataset <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of where dimension-0 represents samples</dd>
</dl>
<dl class="docutils">
<dt>bdataset <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A bootstrap sample of the input dataset</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.cluster_timeseries">
<code class="descclassname">CPAC.basc.</code><code class="descname">cluster_timeseries</code><span class="sig-paren">(</span><em>X</em>, <em>n_clusters</em>, <em>similarity_metric='k_neighbors'</em>, <em>affinity_threshold=0.0</em>, <em>neighbors=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#cluster_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.cluster_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster a given timeseries</p>
<dl class="docutils">
<dt>X <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of shape (<cite>N</cite>, <cite>M</cite>) with <cite>N</cite> samples and <cite>M</cite> dimensions</dd>
<dt>n_clusters <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of clusters</dd>
<dt>similarity_metric <span class="classifier-delimiter">:</span> <span class="classifier">{&#8216;k_neighbors&#8217;, &#8216;correlation&#8217;, &#8216;data&#8217;}</span></dt>
<dd>Type of similarity measure for spectral clustering.  The pairwise similarity measure
specifies the edges of the similarity graph. &#8216;data&#8217; option assumes X as the similarity
matrix and hence must be symmetric.  Default is kneighbors_graph <a href="#id8"><span class="problematic" id="id9"><span id="id4"></span>[1]_</span></a> (forced to be 
symmetric)</dd>
<dt>affinity_threshold <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Threshold of similarity metric when &#8216;correlation&#8217; similarity metric is used.</dd>
</dl>
<dl class="docutils">
<dt>y_pred <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Predicted cluster labels</dd>
</dl>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><a class="reference external" href="http://scikit-learn.org/dev/modules/generated/sklearn.neighbors.kneighbors_graph.html">http://scikit-learn.org/dev/modules/generated/sklearn.neighbors.kneighbors_graph.html</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.adjacency_matrix">
<code class="descclassname">CPAC.basc.</code><code class="descname">adjacency_matrix</code><span class="sig-paren">(</span><em>cluster_pred</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#adjacency_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.adjacency_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate adjacency matrix for given cluster predictions</p>
<dl class="docutils">
<dt>cluster_pred <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of shape (<cite>N</cite>, <cite>1</cite>) with <cite>N</cite> samples</dd>
</dl>
<dl class="docutils">
<dt>A <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Adjacency matrix of shape (<cite>N</cite>,`N`)</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CPAC.basc</span> <span class="kn">import</span> <span class="n">cluster_adjacency_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_adjacency_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
<span class="go">array([[1, 0, 0, 0, 1],</span>
<span class="go">       [0, 1, 1, 0, 0],</span>
<span class="go">       [0, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0],</span>
<span class="go">       [1, 0, 0, 0, 1]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.cluster_matrix_average">
<code class="descclassname">CPAC.basc.</code><code class="descname">cluster_matrix_average</code><span class="sig-paren">(</span><em>M</em>, <em>cluster_assignments</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#cluster_matrix_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.cluster_matrix_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the average element value within a similarity matrix for each cluster assignment, a measure
of within cluster similarity.  Self similarity (diagonal of similarity matrix) is removed.</p>
<p>M : array_like
cluster_assignments : array_like</p>
<p>s : array_like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CPAC</span> <span class="kn">import</span> <span class="n">basc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basc</span><span class="o">.</span><span class="n">cluster_matrix_average</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">assign</span><span class="p">)</span>
<span class="go">array([  6.,   6.,   6.,  21.,  21.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="CPAC.basc.individual_stability_matrix">
<code class="descclassname">CPAC.basc.</code><code class="descname">individual_stability_matrix</code><span class="sig-paren">(</span><em>Y</em>, <em>n_bootstraps</em>, <em>k_clusters</em>, <em>cbb_block_size=None</em>, <em>affinity_threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/basc/utils.html#individual_stability_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.basc.individual_stability_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the individual stability matrix of a single subject by bootstrapping their time-series</p>
<dl class="docutils">
<dt>Y <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of shape (<cite>N</cite>, <cite>V</cite>) with <cite>N</cite> timepoints and <cite>V</cite> voxels</dd>
<dt>n_bootstraps <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of bootstrap samples</dd>
<dt>k_clusters <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>Number of clusters</dd>
<dt>cbb_block_size <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd>Block size to use for the Circular Block Bootstrap algorithm</dd>
<dt>affinity_threshold <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Minimum threshold for similarity matrix based on correlation to create an edge</dd>
</dl>
<dl class="docutils">
<dt>S <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A matrix of shape (<cite>V</cite>, <cite>V</cite>), each element v_{ij} representing the stability of the adjacency of voxel i with voxel j</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sca.html"
                        title="previous chapter">Seed Based Correlation Analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nuisance.html"
                        title="next chapter">Nuisance Signal Removal</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/workflows/basc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nuisance.html" title="Nuisance Signal Removal"
             >next</a> |</li>
        <li class="right" >
          <a href="sca.html" title="Seed Based Correlation Analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">C-PAC 0.3.9 Alpha documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Workflows</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>